<link rel="stylesheet" href="invoice.css">
<script src="./products.js" type="text/javascript"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karma">
<script>
 
    // turning query string into array
        let params = (new URL(document.location)).searchParams;
       
</script>

<!DOCTYPE html>
<html lang="en">
<head>
</head>
<body>
<h1>THE COUNTDOWN</h1>
<div class="page-content container">
                <div class="table-responsive">
                    <table-border="0">
                        <th>Items</th>
                        <th>Quantity</th>
                        <th>Price</th>
                        <th>Total For Watch Type</th>
                    <script> 
                        var subtotal = 0;
                        //loop in order to recieve quantity information from server
                        //Help from Professor Port on this
                        for (i = 0; i < products.length; i++) {
                            if (params.has("quantity"+i))
                            {
                                var q=params.get("quantity"+i);
                            }
                        else {
                            continue;
                        }
                        //computing the total prices
                            var extended_price = (products[i].price * q)
                            subtotal = subtotal + extended_price;
                            if (q != 0) { 
                            //Writing out the items, their quantities, and their prices if the quantity is more than 0
                                document.write(`
                            <tr>
                                <td>${products[i]['name']}</td>
                                <td>${q}</td>
                                <td>$${products[i]['price'].toFixed(2)}</td>
                                <td>$${(products[i]['price'] * q).toFixed(2)}</td>
                            </tr> 
                            </tbody>
                           `);
                            }
                        }
                        </script>
                    </table>
                    </div>
                    <table class = "Shipping Policy">               
                        <tr>
                            <td>
                                <p>Shipping Policy:</p>
                                <p>FREE Shipping for orders over $2,000!</p>
                        
                        </tr>
                    </table> 
                    <div class="Total_cost">
                   <script>
                    //Taken and modified from Blake Saari's ITM Repo from Spring 2022. But also knew concept from Making Change WOD
                        var tax = (subtotal * 0.04)
                        var shippingfee = 0;
                        // Subtotal if less than $20
                            if (subtotal < 2000){
                                shippingfee = (20);
                            // Subtotal if more than $2000
                            } 
                            else if (subtotal > 2000) {
                                shippingfee = 0;
                            }
                        // Total Calculations
                            var total = (subtotal + shippingfee + tax)
                            
                        document.write(`    
                        <div>
                            <div>
                                <div>
                                    Subtotal
                                </div>

                                <div>
                                    <span class="text-120 text-secondary-d1">$${subtotal.toFixed(2)}</span>
                                </div>
                            </div>

                            <div>
                                <div>
                                    Tax (4%)
                                </div>
                                <div class="col-5">
                                    <span class="text-110 text-secondary-d1">$${tax.toFixed(2)}</span>
                                </div>
                            </div>

                            <div>
                                <div>
                                   Shipping Fee
                                </div>
                                <div>
                                    <span class="text-110 text-secondary-d1">$${shippingfee.toFixed(2)}</span>
                                </div>
                            </div>

                            <div>
                                <div>
                                    <b>Your Total:</b>
                                </div>
                                <div>
                                    <span class="text-110 text-secondary-d1">$${total.toFixed(2)}</span>
                                </div>
                            </div>
                        </div>
                    `)
                    </script>
                    </div>
       <div id="thanks"><br>Thank you for your order! Your estimated shipping time is 1-3 business days. Please shop again at The Countdown! </br></div>
</style>
</body>
</html>